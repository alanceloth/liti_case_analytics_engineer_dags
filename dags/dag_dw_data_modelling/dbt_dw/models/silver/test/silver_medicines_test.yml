version: 2
models:
  - name: silver_medicines
    description: "Cleaned and validated medicines data"
    tests:
      # Teste de unicidade e não nulo para o campo medicineId
      - unique:
          column_name: medicineId

      - not_null:
          column_name: medicineId

      # Teste de não nulo para o campo name
      - not_null:
          column_name: name

      # Teste de valores aceitos para o campo type
      - accepted_values:
          column_name: type
          values: ['Obesidade/Compulsão', 'Suplementos/ Reposições/Contracepção', 'Outras medicações', 'others']

      # Teste de consistência para os campos de dosagem (devem ser diferentes de 'N/A')
      - expression_is_true:
          expression: "dosages_0_ NOT IN ('N/A')"
      
      - expression_is_true:
          expression: "dosages_1_ NOT IN ('N/A')"

      - expression_is_true:
          expression: "dosages_2_ NOT IN ('N/A')"

      - expression_is_true:
          expression: "dosages_3_ NOT IN ('N/A')"

      - expression_is_true:
          expression: "dosages_4_ NOT IN ('N/A')"

      - expression_is_true:
          expression: "dosages_5_ NOT IN ('N/A')"

      - expression_is_true:
          expression: "dosages_6_ NOT IN ('N/A')"

      - expression_is_true:
          expression: "dosages_7_ NOT IN ('N/A')"

      # Teste de consistência para o campo deletedAt (deve ser uma data válida ou nulo)
      - expression_is_true:
          expression: "deletedAt IS NULL OR deletedAt <= CURRENT_DATETIME()"
